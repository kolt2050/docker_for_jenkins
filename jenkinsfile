node {
    checkout scm
    cleanWs()
    docker.withRegistry('https://hub.docker.com') {

        docker.image('kolt2050/jenkins_docker_root').inside {
           sh 'docker --version' 
           sh 'echo 1234'
        }
    }
    stage('Clone repo') {
        println("HELLO")
           sh """#!/bin/bash
           id
           ls -la edp-install/

           #rm -rf * 
           #docker rmi -f \$(docker images -q) && docker rm -f \$(docker ps -aq)

           #git clean -fdx
           git clone https://github.com/epam/edp-install.git
           pwd && ls -la
           cd edp-install
           echo "---------we in edp-install----------"
           pwd 

           #sed -i 's/mkdocs-awesome-pages-plugin/mkdocs-awesome-pages-plugin '\n' USER jenkins /' ./hack/mkdocs/Dockerfile
           #echo "RUN useradd -ms /bin/bash jenkins \nUSER jenkins" >> ./hack/mkdocs/Dockerfile
           #cat ./hack/mkdocs/Dockerfile

           #sed -i 's/docker build -t edp-docs/docker build -t edp-docs -u jenkins/' Makefile
           #cat Makefile
           #make edp-docs-image

           sed -i 's/docker run --rm -it/docker run --rm -i/' Makefile 
           cat Makefile
           make build-docs 

           echo "---------------site is here--------------" 
           ls -la ../ 
           mv site ../
           #git checkout gh-pages
           ls -la
           #rm -rf *
           #echo "Clear gh-pages"
           #cp ../site .
           #ls -la
           """
        
    }
}
